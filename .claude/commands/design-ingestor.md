---
allowed-tools: Task, Read, Write, Glob, Grep, AskUserQuestion, TodoWrite
description: Design ingestion strategy with mandatory human review. Use after dataset inspection phase.
---

# Design Ingestor Strategy (Human-in-the-Loop)

This skill orchestrates the schema design phase with **mandatory human approval** before proceeding to implementation.

## Prerequisites

- `Source_Data_Profile.json` must exist (generated by dataset-inspector agent)
- If not found, inform user to run dataset inspection first

## Workflow

### Step 1: Invoke Schema Architect

Call the `schema-architect` agent with the source data profile:

```
Task(subagent_type="schema-architect", prompt="Design ingestion strategy for [dataset] using Source_Data_Profile.json")
```

### Step 2: Present Strategy Summary

After the agent completes, present a concise summary to the user:
- Target class and parent class
- Key column mappings
- Notable transformations
- Potential edge cases

### Step 3: MANDATORY Human Review

**YOU MUST use AskUserQuestion with the following options:**

```
AskUserQuestion:
  question: "Review the Mapping_Strategy.md above. How would you like to proceed?"
  header: "Strategy Review"
  options:
    - label: "Approve"
      description: "Strategy looks good. Proceed to test writing phase."
    - label: "Request Changes"
      description: "I have feedback. Revise the strategy based on my input."
    - label: "Reject"
      description: "Stop the workflow. Strategy needs major rework or is not viable."
```

### Step 4: Handle Response

**If "Approve":**
- Confirm approval and indicate next step (test writing phase)
- Output: "Strategy approved. Ready for Phase 3: Test Writing"

**If "Request Changes":**
- Ask user for specific feedback using AskUserQuestion (free text via "Other")
- Re-invoke schema-architect with the feedback
- Return to Step 2 (present revised strategy)
- **Repeat until approved or rejected**

**If "Reject":**
- Acknowledge rejection
- Clean up any generated artifacts if needed
- Output: "Workflow stopped. Strategy rejected by user."

## Critical Rules

1. **NEVER skip the AskUserQuestion step** - This is the entire purpose of this skill
2. **NEVER proceed to implementation without explicit "Approve"**
3. **Loop on "Request Changes"** - Keep revising until user is satisfied
4. **Track iterations** - If more than 3 revision cycles, suggest pausing to clarify requirements

## Output

On successful approval:
- Confirmed `Mapping_Strategy.md` in project root (local only, do not commit)
- Clear indication that Phase 3 (Test Writing) can begin
